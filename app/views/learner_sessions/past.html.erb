<h1>My Past Sessions</h1>

<% if @past_bookings.any? %>
  <ul class="sessions-list past-sessions">
    <% @past_bookings.each do |booking| %>
      <% session = booking.tutor_session %>
      <li class="session">
        <p><strong>Subject:</strong> <%= session.subject.name %></p>
        <p>
          <strong>Tutor:</strong>
          <%= session.tutor.learner.first_name %>
          <%= session.tutor.learner.last_name %>
        </p>
        <p>
          <strong>Time:</strong>
          <%= session.start_at.utc.iso8601 %> â€“ <%= session.end_at.utc.iso8601 %>
        </p>

        <p>
          <strong>Attendance:</strong>
          <% if booking.attended == true %>
            Present
          <% elsif booking.attended == false %>
            Absent
          <% else %>
            Not recorded
          <% end %>
        </p>

        <% if booking.attended == true %>
          <% if booking.respond_to?(:feedback_submitted) && booking.feedback_submitted %>
            <p><em>Feedback submitted</em></p>
          <% else %>
            <p><%= link_to "Leave Feedback", new_session_feedback_path(session) %></p>
          <% end %>
        <% end %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>You have no past sessions.</p>
<% end %>

<p>
  <%= link_to 'Back to upcoming sessions', learner_sessions_path %>
</p>
